<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏´‡∏•‡∏±‡∏á‡∏ö‡πâ‡∏≤‡∏ô - ‡∏Ç‡∏ô‡∏≥‡∏•‡∏∏‡∏á‡∏î‡∏≥ ‡πÅ‡∏Ñ‡∏°‡∏õ‡πå‡∏õ‡∏¥‡πâ‡∏á</title>
    
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body class="bg-gray-100">
    <div id="root"></div>

    <script type="text/babel">
        const GOOGLE_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwQjaz5oaVekrtSlw_kGqt9gLOg0uQeXphG4H2Q5cqrv4ZSEiJnzO63lctvaaYTRr9HNQ/exec"; 

        const AdminApp = () => {
            const [isLoggedIn, setIsLoggedIn] = React.useState(false);
            const [password, setPassword] = React.useState('');
            const [loading, setLoading] = React.useState(false);
            const [activeTab, setActiveTab] = React.useState('dashboard'); 
            
            const [bookings, setBookings] = React.useState([]);
            const [settings, setSettings] = React.useState({ discounts: [], closed: [], special: [] });
            
            // CMS Data
            const [cmsData, setCmsData] = React.useState({ foodMenu: [], roomImages: {} });

            const [viewSlip, setViewSlip] = React.useState(null); 
            const [viewBooking, setViewBooking] = React.useState(null); 
            const [filter, setFilter] = React.useState('all'); 
            const [rescheduleData, setRescheduleData] = React.useState(null);

            // States for Forms
            const [editMode, setEditMode] = React.useState(null); 
            const [formDiscount, setFormDiscount] = React.useState({ code: '', type: 'FIXED', value: '' });
            const [formClosed, setFormClosed] = React.useState({ date: '', reason: '' });
            const [formSpecial, setFormSpecial] = React.useState({ date: '', desc: '' });

            // CMS Forms
            const [formFood, setFormFood] = React.useState({ name: '', price: '', imgBase64: null });
            const [formRoomImg, setFormRoomImg] = React.useState({ roomId: 'R1', imgBase64: null });

            const formatThaiDate = (dateStr) => {
                if(!dateStr || dateStr === '-') return "-";
                const date = new Date(dateStr);
                const months = ["‡∏°.‡∏Ñ.", "‡∏Å.‡∏û.", "‡∏°‡∏µ.‡∏Ñ.", "‡πÄ‡∏°.‡∏¢.", "‡∏û.‡∏Ñ.", "‡∏°‡∏¥.‡∏¢.", "‡∏Å.‡∏Ñ.", "‡∏™.‡∏Ñ.", "‡∏Å.‡∏¢.", "‡∏ï.‡∏Ñ.", "‡∏û.‡∏¢.", "‡∏ò.‡∏Ñ."];
                return `${date.getDate()} ${months[date.getMonth()]} ${date.getFullYear() + 543}`;
            };

            const handleLogin = (e) => {
                e.preventDefault();
                setLoading(true);
                fetch(GOOGLE_SCRIPT_URL, { method: 'POST', body: JSON.stringify({ action: 'adminLogin', password: password }) })
                .then(r => r.json()).then(res => {
                    setLoading(false);
                    if (res.status === 'success') {
                        setIsLoggedIn(true);
                        fetchData();
                        fetchSettings();
                        fetchCmsData();
                    } else alert('‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á');
                });
            };

            const fetchData = () => fetch(GOOGLE_SCRIPT_URL, { method: 'POST', body: JSON.stringify({ action: 'getAdminData', password: password }) }).then(r=>r.json()).then(res=>{ if(res.status==='success') setBookings(res.data); });
            const fetchSettings = () => fetch(GOOGLE_SCRIPT_URL, { method: 'POST', body: JSON.stringify({ action: 'getSettings', password: password }) }).then(r=>r.json()).then(res=>{ if(res.status==='success') setSettings(res); });
            
            const fetchCmsData = () => {
                fetch(`${GOOGLE_SCRIPT_URL}?action=getPublicData`)
                .then(r=>r.json()).then(res => {
                    if (res.status === 'success') setCmsData({ foodMenu: res.foodMenu, roomImages: res.roomImages });
                });
            }

            // --- Stats Calculation ---
            const stats = React.useMemo(() => {
                const now = new Date();
                const totalRevenue = bookings.filter(b => b.status === '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô').reduce((sum, b) => sum + parseInt(b.deposit || 0), 0);
                const monthlyRevenue = bookings.filter(b => {
                        const d = new Date(b.checkIn);
                        return b.status === '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô' && d.getMonth() === now.getMonth() && d.getFullYear() === now.getFullYear();
                    }).reduce((sum, b) => sum + parseInt(b.deposit || 0), 0);
                const pendingCount = bookings.filter(b => b.status === '‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö').length;
                const upcoming = bookings.filter(b => {
                    const checkIn = new Date(b.checkIn);
                    const diffTime = checkIn - now;
                    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24)); 
                    return b.status === '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô' && diffDays >= 0 && diffDays <= 3;
                }).sort((a,b) => new Date(a.checkIn) - new Date(b.checkIn));
                return { totalRevenue, monthlyRevenue, pendingCount, upcoming };
            }, [bookings]);

            // --- Action Handlers ---
            const handleExport = () => {
                const header = ["BookingID", "Date", "Customer", "Phone", "CheckIn", "CheckOut", "Rooms", "Total", "Deposit", "Status"];
                const rows = bookings.map(b => [b.id, b.timestamp, `"${b.name}"`, `'${b.phone}`, b.checkIn, b.checkOut, `"${b.rooms.replace(/"/g, '""')}"`, b.price, b.deposit, b.status]);
                const csvContent = [header.join(","), ...rows.map(r => r.join(","))].join("\n");
                const blob = new Blob(["\uFEFF"+csvContent], { type: 'text/csv;charset=utf-8;' });
                const url = URL.createObjectURL(blob);
                const link = document.createElement("a"); link.setAttribute("href", url); link.setAttribute("download", "bookings.csv");
                document.body.appendChild(link); link.click(); document.body.removeChild(link);
            };

            const updateStatus = (id, newStatus) => {
                if(!confirm(`‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡πá‡∏ô "${newStatus}"?`)) return;
                setBookings(prev => prev.map(b => b.id === id ? {...b, status: newStatus} : b));
                fetch(GOOGLE_SCRIPT_URL, { method: 'POST', body: JSON.stringify({ action: 'updateStatus', bookingId: id, newStatus: newStatus, password: password }) });
            };

            const handleReschedule = () => {
                if(!rescheduleData.checkIn || !rescheduleData.checkOut) return alert('‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà');
                if(!confirm('‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô?')) return;
                fetch(GOOGLE_SCRIPT_URL, { method: 'POST', body: JSON.stringify({ action: 'rescheduleBooking', bookingId: rescheduleData.id, newCheckIn: rescheduleData.checkIn, newCheckOut: rescheduleData.checkOut, password: password }) })
                .then(r=>r.json()).then(res => { if(res.status==='success'){ alert('‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à'); setRescheduleData(null); setViewBooking(null); fetchData(); } else alert(res.message); });
            };

            // Generic Save/Delete Settings
            const handleSaveSetting = (type, payload) => {
                const action = editMode ? 'editSetting' : 'addSetting'; const id = editMode ? editMode.id : null;
                if(!confirm('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å?')) return;
                fetch(GOOGLE_SCRIPT_URL, { method: 'POST', body: JSON.stringify({ action, type, id, payload, password: password }) })
                .then(r=>r.json()).then(res => { if(res.status==='success'){ fetchSettings(); setEditMode(null); } });
            };
            const handleDeleteSetting = (type, id) => { if(confirm('‡∏•‡∏ö?')) fetch(GOOGLE_SCRIPT_URL, { method: 'POST', body: JSON.stringify({ action: 'deleteSetting', type, id, password: password }) }).then(r=>r.json()).then(res=>fetchSettings()); };

            // CMS Handlers
            const handleFile = (e, setFn) => {
                const file = e.target.files[0];
                const reader = new FileReader();
                reader.onloadend = () => setFn(prev => ({ ...prev, imgBase64: reader.result }));
                if(file) reader.readAsDataURL(file);
            };

            const saveFood = () => {
                if(!formFood.name || !formFood.price) return alert('‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏•‡∏∞‡∏£‡∏≤‡∏Ñ‡∏≤');
                if(!confirm('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏°‡∏ô‡∏π?')) return;
                setLoading(true);
                fetch(GOOGLE_SCRIPT_URL, { method: 'POST', body: JSON.stringify({ action: 'saveFood', payload: formFood, password: password }) })
                .then(r=>r.json()).then(res => { setLoading(false); if(res.status==='success') { fetchCmsData(); setFormFood({name:'', price:'', imgBase64:null}); alert('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à'); } });
            };

            const deleteFood = (id) => {
                if(confirm('‡∏•‡∏ö‡πÄ‡∏°‡∏ô‡∏π?')) fetch(GOOGLE_SCRIPT_URL, { method: 'POST', body: JSON.stringify({ action: 'deleteFood', id, password: password }) }).then(r=>r.json()).then(res=>fetchCmsData());
            };

            const saveRoomImg = () => {
                if(!formRoomImg.imgBase64) return alert('‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û');
                if(!confirm('‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ?')) return;
                setLoading(true);
                fetch(GOOGLE_SCRIPT_URL, { method: 'POST', body: JSON.stringify({ action: 'saveRoomImage', payload: formRoomImg, password: password }) })
                .then(r=>r.json()).then(res => { setLoading(false); if(res.status==='success') { fetchCmsData(); setFormRoomImg({...formRoomImg, imgBase64:null}); alert('‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à'); } });
            };
            
            const deleteRoomImg = (url) => {
                if(confirm('‡∏•‡∏ö‡∏£‡∏π‡∏õ‡∏ô‡∏µ‡πâ?')) fetch(GOOGLE_SCRIPT_URL, { method: 'POST', body: JSON.stringify({ action: 'deleteRoomImage', id: url, password: password }) }).then(r=>r.json()).then(res=>fetchCmsData());
            };


            // --- VIEWS ---
            if (!isLoggedIn) return (
                <div className="min-h-screen flex items-center justify-center bg-gray-900 px-4">
                    <div className="bg-white p-8 rounded-xl shadow-2xl w-full max-w-sm">
                        <h1 className="text-3xl font-bold text-center text-green-800 mb-6">Admin Panel</h1>
                        <form onSubmit={handleLogin} className="space-y-4">
                            <input type="password" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô" className="w-full p-3 border rounded-lg" value={password} onChange={e => setPassword(e.target.value)} />
                            <button disabled={loading} className="w-full bg-gray-800 text-white p-3 rounded-lg">{loading ? '...' : '‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö'}</button>
                        </form>
                    </div>
                </div>
            );

            return (
                <div className="min-h-screen pb-20 bg-gray-100">
                    <nav className="bg-white shadow p-3 sticky top-0 z-20 flex justify-between items-center">
                        <div className="font-bold text-lg text-green-800">üèïÔ∏è ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡∏∞‡∏ö‡∏ö</div>
                        <div className="flex gap-2">
                            <button onClick={fetchData} className="w-8 h-8 bg-gray-100 rounded-full text-gray-600"><i className="fas fa-sync"></i></button>
                            <button onClick={() => window.location.reload()} className="w-8 h-8 bg-red-50 rounded-full text-red-500"><i className="fas fa-power-off"></i></button>
                        </div>
                    </nav>

                    <div className="max-w-7xl mx-auto p-3 md:p-6">
                        <div className="flex gap-2 mb-4 overflow-x-auto">
                            {['dashboard', 'bookings', 'calendar', 'settings', 'cms'].map(t => (
                                <button key={t} onClick={() => setActiveTab(t)} className={`px-4 py-2 rounded-full text-xs font-bold whitespace-nowrap ${activeTab===t ? 'bg-green-600 text-white' : 'bg-white text-gray-600 shadow'}`}>
                                    {t==='dashboard'?'üìä ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°': t==='bookings'?'üìã ‡∏à‡∏≠‡∏á': t==='calendar'?'üìÖ ‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô': t==='settings'?'‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤': 'üñºÔ∏è ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤'}
                                </button>
                            ))}
                        </div>

                        {activeTab === 'dashboard' && (
                            <div className="space-y-4">
                                <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                                    <div className="bg-white p-4 rounded-xl shadow-sm border-l-4 border-green-500">
                                        <div className="text-gray-500 text-xs">‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏£‡∏ß‡∏°</div><div className="text-xl font-bold text-green-700">{stats.totalRevenue.toLocaleString()}</div>
                                    </div>
                                    <div className="bg-white p-4 rounded-xl shadow-sm border-l-4 border-blue-500">
                                        <div className="text-gray-500 text-xs">‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ</div><div className="text-xl font-bold text-blue-700">{stats.monthlyRevenue.toLocaleString()}</div>
                                    </div>
                                    <div className="bg-white p-4 rounded-xl shadow-sm border-l-4 border-yellow-500">
                                        <div className="text-gray-500 text-xs">‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</div><div className="text-xl font-bold text-yellow-600">{stats.pendingCount}</div>
                                    </div>
                                </div>
                                <div className="bg-white p-4 rounded-xl shadow-sm">
                                    <h3 className="font-bold text-gray-700 mb-2">‡πÄ‡∏Ç‡πâ‡∏≤‡∏û‡∏±‡∏Å‡πÄ‡∏£‡πá‡∏ß‡πÜ ‡∏ô‡∏µ‡πâ</h3>
                                    {stats.upcoming.length === 0 ? <p className="text-gray-400 text-xs">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</p> : stats.upcoming.map(b => (
                                        <div key={b.id} onClick={()=>setViewBooking(b)} className="flex justify-between p-2 bg-green-50 rounded mb-1 cursor-pointer">
                                            <div className="text-sm font-bold">{b.name}</div><div className="text-xs text-green-700">{formatThaiDate(b.checkIn)}</div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}

                        {activeTab === 'bookings' && (
                            <div>
                                <div className="flex justify-between mb-4">
                                    <div className="flex gap-2">{['all', 'pending', 'confirmed'].map(f=><button key={f} onClick={()=>setFilter(f)} className={`px-2 py-1 rounded text-xs ${filter===f?'bg-gray-800 text-white':'bg-white'}`}>{f}</button>)}</div>
                                    <button onClick={handleExport} className="bg-green-600 text-white px-3 py-1 rounded text-xs"><i className="fas fa-file-excel"></i> Export</button>
                                </div>
                                <div className="space-y-3">
                                    {bookings.filter(b => filter==='all' || (filter==='pending' && b.status==='‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö') || (filter==='confirmed' && b.status==='‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô')).map(b => (
                                        <div key={b.id} className="bg-white rounded-lg shadow p-4 border-l-4 border-green-500">
                                            <div className="flex justify-between mb-2">
                                                <div><div className="text-xs text-gray-400">{b.id}</div><div className="font-bold">{b.name}</div></div>
                                                <span className={`px-2 py-1 rounded text-xs font-bold ${b.status==='‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô'?'bg-green-100 text-green-800': b.status==='‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö'?'bg-yellow-100 text-yellow-800':'bg-red-100'}`}>{b.status}</span>
                                            </div>
                                            <div className="text-sm text-gray-600 mb-2">{formatThaiDate(b.checkIn)} - {formatThaiDate(b.checkOut)}</div>
                                            <div className="bg-gray-50 p-2 rounded text-xs mb-2 text-green-800">{b.rooms}</div>
                                            <div className="flex justify-between items-end">
                                                <div><div className="text-xs text-gray-400">‡∏°‡∏±‡∏î‡∏à‡∏≥</div><div className="font-bold text-red-600">{parseInt(b.deposit).toLocaleString()}</div></div>
                                                <div className="flex gap-2">
                                                    {b.slip.includes('http') && <button onClick={() => setViewSlip(b.slip)} className="bg-blue-50 text-blue-600 p-2 rounded"><i className="fas fa-image"></i></button>}
                                                    <button onClick={() => setViewBooking(b)} className="bg-orange-50 text-orange-600 p-2 rounded"><i className="fas fa-calendar-alt"></i></button>
                                                    {b.status === '‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö' && <><button onClick={() => updateStatus(b.id, '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô')} className="bg-green-600 text-white p-2 rounded">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô</button><button onClick={() => updateStatus(b.id, '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å')} className="bg-red-50 text-red-500 p-2 rounded">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button></>}
                                                </div>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}

                        {activeTab === 'calendar' && <div className="bg-white p-4 rounded text-center text-gray-500">‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô (‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°)</div>}

                        {activeTab === 'settings' && (
                            <div className="space-y-6">
                                <div className="bg-white p-4 rounded-lg shadow">
                                    <h3 className="font-bold text-green-800 mb-2">‡πÇ‡∏Ñ‡πâ‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î</h3>
                                    <div className="flex gap-2 mb-2"><input placeholder="Code" className="border p-1 w-20 text-sm" value={formDiscount.code} onChange={e=>setFormDiscount({...formDiscount,code:e.target.value})}/><input placeholder="Value" type="number" className="border p-1 w-16 text-sm" value={formDiscount.value} onChange={e=>setFormDiscount({...formDiscount,value:e.target.value})}/><button onClick={()=>handleSaveSetting('discount',formDiscount)} className="bg-green-600 text-white px-2 rounded text-sm">+</button></div>
                                    <ul>{settings.discounts.map(d=><li key={d.id} className="flex justify-between text-sm border-b py-1"><span>{d.code} (-{d.value})</span><button onClick={()=>handleDeleteSetting('discount',d.id)} className="text-red-500">x</button></li>)}</ul>
                                </div>
                                <div className="bg-white p-4 rounded-lg shadow">
                                    <h3 className="font-bold text-red-800 mb-2">‡∏ß‡∏±‡∏ô‡∏õ‡∏¥‡∏î‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£</h3>
                                    <div className="flex gap-2 mb-2"><input type="date" className="border p-1 text-sm" value={formClosed.date} onChange={e=>setFormClosed({...formClosed,date:e.target.value})}/><input placeholder="‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•" className="border p-1 flex-1 text-sm" value={formClosed.reason} onChange={e=>setFormClosed({...formClosed,reason:e.target.value})}/><button onClick={()=>handleSaveSetting('closed',formClosed)} className="bg-red-600 text-white px-2 rounded text-sm">+</button></div>
                                    <ul>{settings.closed.map(c=><li key={c.id} className="flex justify-between text-sm border-b py-1 text-red-600"><span>{formatThaiDate(c.date)}: {c.reason}</span><button onClick={()=>handleDeleteSetting('closed',c.id)} className="text-red-500">x</button></li>)}</ul>
                                </div>
                            </div>
                        )}

                        {activeTab === 'cms' && (
                            <div className="space-y-6">
                                {/* Food Manager */}
                                <div className="bg-white p-4 rounded-lg shadow">
                                    <h3 className="font-bold text-lg mb-4 text-orange-800">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏°‡∏ô‡∏π‡∏≠‡∏≤‡∏´‡∏≤‡∏£</h3>
                                    <div className="flex gap-2 mb-4 flex-wrap items-end bg-orange-50 p-2 rounded">
                                        <input placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏≤‡∏´‡∏≤‡∏£" className="border p-2 rounded text-sm flex-1" value={formFood.name} onChange={e=>setFormFood({...formFood, name:e.target.value})} />
                                        <input placeholder="‡∏£‡∏≤‡∏Ñ‡∏≤" type="number" className="border p-2 rounded text-sm w-20" value={formFood.price} onChange={e=>setFormFood({...formFood, price:e.target.value})} />
                                        <input type="file" accept="image/*" className="text-xs" onChange={e=>handleFile(e, setFormFood)} />
                                        <button onClick={saveFood} disabled={loading} className="bg-orange-600 text-white px-3 py-2 rounded text-sm">{loading?'...':'‡πÄ‡∏û‡∏¥‡πà‡∏°'}</button>
                                    </div>
                                    <div className="grid grid-cols-2 gap-4">
                                        {cmsData.foodMenu.map(f => (
                                            <div key={f.id} className="flex items-center gap-2 border p-2 rounded bg-gray-50">
                                                <img src={f.img} className="w-12 h-12 object-cover rounded" />
                                                <div className="flex-1 min-w-0">
                                                    <div className="font-bold text-sm truncate">{f.name}</div>
                                                    <div className="text-xs text-gray-500">{f.price} ‡∏ö‡∏≤‡∏ó</div>
                                                </div>
                                                <button onClick={()=>deleteFood(f.rowId)} className="text-red-500"><i className="fas fa-trash"></i></button>
                                            </div>
                                        ))}
                                    </div>
                                </div>

                                {/* Room Image Manager */}
                                <div className="bg-white p-4 rounded-lg shadow">
                                    <h3 className="font-bold text-lg mb-4 text-blue-800">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡∏π‡∏õ‡∏´‡πâ‡∏≠‡∏á‡∏û‡∏±‡∏Å</h3>
                                    <div className="flex gap-2 mb-4 flex-wrap items-end bg-blue-50 p-2 rounded">
                                        <select className="border p-2 rounded text-sm" value={formRoomImg.roomId} onChange={e=>setFormRoomImg({...formRoomImg, roomId:e.target.value})}>
                                            <option value="R1">‡πÇ‡∏Æ‡∏°‡∏™‡πÄ‡∏ï‡∏¢‡πå‡∏´‡∏ô‡∏≥‡πÇ‡∏õ</option><option value="R2">‡∏ö‡πâ‡∏≤‡∏ô‡∏û‡∏±‡∏Å‡∏£‡∏¥‡∏°‡∏ô‡πâ‡∏≥ 1</option><option value="R3">‡∏ö‡πâ‡∏≤‡∏ô‡∏û‡∏±‡∏Å‡∏£‡∏¥‡∏°‡∏ô‡πâ‡∏≥ 2</option>
                                            <option value="T1">‡πÄ‡∏ï‡πá‡∏ô‡∏ó‡πå‡∏Å‡∏£‡∏∞‡πÇ‡∏à‡∏° 1</option><option value="T2">‡πÄ‡∏ï‡πá‡∏ô‡∏ó‡πå‡∏Å‡∏£‡∏∞‡πÇ‡∏à‡∏° 2</option><option value="K1">‡πÄ‡∏ï‡πá‡∏ô‡∏ó‡πå‡∏™‡∏ô‡∏≤‡∏° K1</option>
                                            <option value="K2">‡πÄ‡∏ï‡πá‡∏ô‡∏ó‡πå‡∏™‡∏ô‡∏≤‡∏° K2</option><option value="Z8">‡∏•‡∏≤‡∏ô‡∏Å‡∏≤‡∏á‡πÄ‡∏ï‡πá‡∏ô‡∏ó‡πå</option>
                                        </select>
                                        <input type="file" accept="image/*" className="text-xs" onChange={e=>handleFile(e, setFormRoomImg)} />
                                        <button onClick={saveRoomImg} disabled={loading} className="bg-blue-600 text-white px-3 py-2 rounded text-sm">{loading?'...':'‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î'}</button>
                                    </div>
                                    <div className="grid grid-cols-3 gap-2">
                                        {Object.keys(cmsData.roomImages).map(rid => (
                                            <div key={rid} className="col-span-3">
                                                <h4 className="font-bold text-sm mt-2">{rid}</h4>
                                                <div className="flex gap-2 overflow-x-auto pb-2">
                                                    {cmsData.roomImages[rid].map((url, idx) => (
                                                        <div key={idx} className="relative flex-shrink-0 w-24 h-24">
                                                            <img src={url} className="w-full h-full object-cover rounded border" />
                                                            <button onClick={()=>deleteRoomImg(url)} className="absolute top-0 right-0 bg-red-500 text-white w-5 h-5 rounded-full text-xs">x</button>
                                                        </div>
                                                    ))}
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            </div>
                        )}
                    </div>
                    
                    {/* Reuse Modal for Booking Details & Slip from previous version (Simplified here) */}
                    {viewSlip && <div className="fixed inset-0 bg-black bg-opacity-90 flex justify-center items-center z-50" onClick={()=>setViewSlip(null)}><img src={viewSlip} className="max-h-[90vh]" /></div>}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<AdminApp />);
    </script>
</body>
</html>
